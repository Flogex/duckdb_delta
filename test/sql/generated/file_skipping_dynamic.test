# name: test/sql/generated/file_skipping_dynamic.test
# description: Test dynamic filter pushdown
# group: [delta_generated]

require parquet

require delta

require-env GENERATED_DATA_AVAILABLE

statement ok
set enable_logging=true;

statement ok
set delta_kernel_logging=true;

statement ok
set logging_level = 'TRACE';

statement ok
CREATE TABLE test AS SELECT 2 d;

query III
SELECT value1, value3, value2 as v2,
FROM delta_scan('./data/generated/test_file_skipping/int/delta_lake')
WHERE v2 = (SELECT min(d) from test)
----
2	2	2

query I
SELECT message from duckdb_logs where type = 'delta.DynamicFilterPushdown';
----
value2=2