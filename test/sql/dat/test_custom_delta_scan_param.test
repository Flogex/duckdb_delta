# name: test/sql/dat/test_custom_delta_scan_param.test
# description: DAT test suite: use the basic append test to test the delta_file_number param 
# group: [delta]

require parquet

require delta

require-env DAT_AVAILABLE

# Note: this table has 2 parquet files:
# - part-00000-ef42f28f-e8e8-4d54-b51f-c3af96c72a44-c000.snappy.parquet
#   - contains letters a,b,c
# - part-00000-c156ac8b-f738-4479-803d-750072dd4c51-c000.snappy.parquet
# 	- contains letters d,e

query II
SELECT letter, number
FROM delta_scan('./delta-kernel-rs/acceptance/tests/dat/out/reader_tests/generated/basic_append/delta')
----
d	4
e	5
a	1
b	2
c	3

mode skip

# Demo delta_file_number parameter (i.e. Delta extension provided)
query III
SELECT letter, number, delta_file_number
FROM delta_scan('./delta-kernel-rs/acceptance/tests/dat/out/reader_tests/generated/basic_append/delta', delta_file_number=1, file_row_number=1)
----
d	4	0
e	5	0
a	1	1
b	2	1
c	3	1
